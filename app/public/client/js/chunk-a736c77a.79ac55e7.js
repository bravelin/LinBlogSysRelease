(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a736c77a"],{1322:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-container article-page clock-page"},[n("iframe",{staticStyle:{display:"none"},attrs:{frameborder:"no",border:"0",marginwidth:"0",marginheight:"0",width:"0",height:"0",src:"//music.163.com/outchain/player?type=2&id=32685948&auto=1&height=66"}}),n("h2",{staticClass:"title"},[t._v("Canvas绘制的时钟")]),n("div",{staticClass:"content"},[n("div",{ref:"grid",staticClass:"exp"},[n("canvas",{ref:"clock",staticClass:"clock",attrs:{width:"400",height:"400"}})]),n("h3",{staticClass:"title"},[t._v("The Code")]),n("p",[t._v("data定义：")]),t._m(0),n("p",[t._v("初始化部分：")]),t._m(1),n("p",[t._v("绘制整个时钟的方法：")]),t._m(2),n("p",[t._v("随着时间重绘：")]),t._m(3),n("p",[t._v("绘制底层网格：")]),t._m(4),n("p",[t._v("绘制中心点：")]),t._m(5),n("p",[t._v("绘制圆环：")]),t._m(6),n("p",[t._v("绘制刻度：")]),t._m(7),n("p",[t._v("绘制指针以及时间文本：")]),t._m(8)]),n("footer",[t._v("2017年06月17日")]),n("Comments"),n("Catalog",{attrs:{catalog:t.catalog}})],1)},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("data () {\n    return {\n        context: null,\n        centerX: 0, // 中心点\n        centerY: 0,\n        ringInnerRadius: 150, // 内圆环半径\n        ringOuterRadius: 170, // 外圆环半径\n        hourTickLen: 10, // 大刻度长度\n        minTickLen: 5, // 小刻度长度\n        lastTime: 0 // 上次的时间\n    }\n}")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("init () {\n    let that = this\n    let refs = that.$refs\n    let el = refs.clock\n    let box = refs.grid\n    let rect = box.getBoundingClientRect()\n    let w = (rect.right - rect.left) * 0.95\n    if (w < 400) {\n        el.style.width = w + 'px'\n        el.style.height = w + 'px'\n    }\n    let canvasWidth = el.getAttribute('width')\n    let canvasHeight = el.getAttribute('height')\n    that.centerX = canvasWidth / 2\n    that.centerY = canvasHeight / 2\n    that.context = el.getContext('2d')\n    that.startTimer()\n}")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("drawClock () {\n    let that = this\n    if (parseInt(that.lastTime / 1000) != parseInt((+new Date()) / 1000)) {\n        that.drawGrid()\n        that.drawCentroid()\n        that.drawRing()\n        that.drawTicks()\n        that.drawPoints()\n    }\n}")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("startTimer () {\n    let that = this\n    let requestAnimationFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame\n    requestAnimationFrame(function () {\n        that.drawClock()\n        that.startTimer()\n    })\n}")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("drawGrid () {\n    let that = this\n    let context = that.context\n    let el = context.canvas\n    let w = el.width\n    let h = el.height\n    let stepX = 10\n    let stepY = 10\n\n    context.clearRect(0, 0, w, h)\n    context.save()\n    context.beginPath()\n    context.strokeStyle = 'rgba(0,0,0,0.05)'\n    context.lineWidth = 0.5\n    for (let i = stepX + 0.5; i < w; i += stepX) {\n        context.beginPath()\n        context.moveTo(i, 0)\n        context.lineTo(i, h)\n        context.stroke()\n    }\n\n    for (let j = stepY + 0.5; j < h; j += stepY) {\n        context.beginPath()\n        context.moveTo(0, j)\n        context.lineTo(w, j)\n        context.stroke()\n    }\n    context.restore()\n}")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("drawCentroid () {\n    let that = this\n    let context = that.context\n    context.save()\n    context.beginPath()\n    context.strokeStyle = 'rgba(0,0,0,0.3)'\n    context.fillStyle = 'rgba(0,0,0,0.25)'\n    context.arc(that.centerX, that.centerY, 10, 0, 2 * Math.PI, true)\n    context.stroke()\n    context.fill()\n    context.restore()\n}")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("drawRing () {\n    let that = this\n    let context = that.context\n    context.save()\n    context.beginPath()\n\n    // 外侧的圆\n    context.shadowColor = 'rgba(0,0,0,0.7)'\n    context.shadowOffsetX = 4\n    context.shadowOffsetY = 4\n    context.shadowBlur = 8\n    context.fillStyle = 'rgba(0,0,0,0.16)'\n    context.strokeStyle = 'rgba(0,0,0,0.25)'\n    context.arc(that.centerX, that.centerY, that.ringOuterRadius, 0, 2 * Math.PI, false)\n    context.stroke()\n    // 内侧的圆\n    context.strokeStyle = 'rgba(0,0,0,0.2)'\n    context.arc(that.centerX, that.centerY, that.ringInnerRadius, 0, 2 * Math.PI, true)\n    context.fill()\n    context.beginPath()\n    context.arc(that.centerX, that.centerY, that.ringInnerRadius, 0, 2 * Math.PI, true)\n    context.stroke()\n    context.restore()\n}")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("drawTicks () {\n    let that = this\n    let context = that.context\n    let hourTickRadius = that.ringInnerRadius - that.hourTickLen\n    let minTickRadius = that.ringInnerRadius - that.minTickLen\n    let pi = Math.PI\n    let startEngle = -(pi / 2)\n    let deltEngle = 2 * pi / (4 * 12)\n    let startPointX = 0\n    let startPointY = 0\n    let endPointX = 0\n    let endPointY = 0\n    let currEngle = startEngle\n    let currTickLen\n    let num\n\n    context.save()\n    context.lineWidth = 1\n    context.textAlign = 'center'\n    context.textBaseline = 'middle'\n    context.font = '12px 微软雅黑 normal'\n    for (let i = 0; i < 48; i++) {\n        currTickLen = (i % 4 == 0 ? hourTickRadius : minTickRadius)\n        context.lineWidth = (i % 4 == 0 ? 2 : 1)\n        context.strokeStyle = 'rgba(0,0,0,0.2)'\n        startPointX = that.centerX + Math.cos(currEngle) * currTickLen\n        startPointY = that.centerY + Math.sin(currEngle) * currTickLen\n        endPointX = that.centerX + Math.cos(currEngle) * that.ringInnerRadius\n        endPointY = that.centerY + Math.sin(currEngle) * that.ringInnerRadius\n        context.beginPath()\n        context.moveTo(startPointX, startPointY)\n        context.lineTo(endPointX, endPointY)\n        context.stroke()\n        if (i % 4 == 0) { // 绘制数字\n            num = i / 4\n            num = (num == 0 ? 12 : num)\n            context.strokeStyle = 'rgba(0,0,0,0.5)'\n            context.strokeText(num, that.centerX + Math.cos(currEngle) * (currTickLen - 10), that.centerY + Math.sin(currEngle) * (currTickLen - 10))\n        }\n        currEngle += deltEngle\n    }\n    context.restore()\n}")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("drawPoints () {\n    let that = this\n    let context = that.context\n    let pi = Math.PI\n    let currDate = new Date()\n    let hour = currDate.getHours()\n    let min = currDate.getMinutes()\n    let second = currDate.getSeconds()\n    let hourPointLen = 55\n    let hourEngle = -(pi / 2) + (2 * pi / 12) * (hour % 12)\n    let minPointLen = 85\n    let minEngle = -(pi / 2) + (2 * pi / 60) * min\n    let secondPointLen = 115\n    let secondEngle = -(pi / 2) + (2 * pi / 60) * second\n    that.lastTime = currDate.getTime()\n    context.save()\n    context.lineCap = 'round'\n    context.strokeStyle = 'rgba(0,0,0,0.5)'\n    // 小时的指针\n    context.lineWidth = 4\n    context.beginPath()\n    context.moveTo(that.centerX, that.centerY)\n    context.lineTo(that.centerX + hourPointLen * Math.cos(hourEngle), that.centerY + hourPointLen * Math.sin(hourEngle))\n    context.stroke()\n\n    // 分钟的指针\n    context.lineWidth = 3\n    context.beginPath()\n    context.moveTo(that.centerX, that.centerY)\n    context.lineTo(that.centerX + minPointLen * Math.cos(minEngle), that.centerY + minPointLen * Math.sin(minEngle))\n    context.stroke()\n\n    // 秒的指针\n    context.lineWidth = 2\n    context.beginPath()\n    context.moveTo(that.centerX, that.centerY)\n    context.lineTo(that.centerX + secondPointLen * Math.cos(secondEngle), that.centerY + secondPointLen * Math.sin(secondEngle))\n    context.stroke()\n\n    // 当前时间文本\n    let timeStr = (hour < 10 ? '0' + hour : hour) + ' : ' + (min < 10 ? '0' + min : min) + ' : ' + (second < 10 ? '0' + second : second)\n    context.font = '14px 微软雅黑 normal'\n    context.textAlign = 'center'\n    context.textBaseline = 'middle'\n    context.strokeStyle = 'rgba(0,0,0,0.5)'\n    context.lineWidth = 1\n    context.strokeText(timeStr, that.centerX, that.centerY + 45)\n    let month = currDate.getMonth() + 1\n    let date = currDate.getDate()\n    let day = currDate.getDay()\n    let weekObj = ['日', '一', '二', '三', '四', '五', '六']\n    timeStr = currDate.getFullYear() + ' / ' + (month < 10 ? '0' + month : month) + ' / ' + (date < 10 ? '0' + date : date) + ' 星期' + weekObj[day]\n    context.strokeText(timeStr, that.centerX, that.centerY + 75)\n    context.restore()\n}")])])}],a=(n("1c74"),n("3ad6")),o={extends:a["a"],data:function(){return{context:null,centerX:0,centerY:0,ringInnerRadius:150,ringOuterRadius:170,hourTickLen:10,minTickLen:5,lastTime:0}},mounted:function(){var t=this;t.$nextTick(function(){t.init()})},methods:{init:function(){var t=this,e=t.$refs,n=e.clock,r=e.grid,i=r.getBoundingClientRect(),a=.95*(i.right-i.left);a<400&&(n.style.width=a+"px",n.style.height=a+"px");var o=n.getAttribute("width"),c=n.getAttribute("height");t.centerX=o/2,t.centerY=c/2,t.context=n.getContext("2d"),t.startTimer()},startTimer:function(){var t=this,e=window.requestAnimationFrame||window.webkitRequestAnimationFrame;e(function(){t.drawClock(),t.startTimer()})},drawClock:function(){var t=this;parseInt(t.lastTime/1e3)!=parseInt(+new Date/1e3)&&(t.drawGrid(),t.drawCentroid(),t.drawRing(),t.drawTicks(),t.drawPoints())},drawGrid:function(){var t=this,e=t.context,n=e.canvas,r=n.width,i=n.height,a=10,o=10;e.clearRect(0,0,r,i),e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,0.05)",e.lineWidth=.5;for(var c=a+.5;c<r;c+=a)e.beginPath(),e.moveTo(c,0),e.lineTo(c,i),e.stroke();for(var s=o+.5;s<i;s+=o)e.beginPath(),e.moveTo(0,s),e.lineTo(r,s),e.stroke();e.restore()},drawCentroid:function(){var t=this,e=t.context;e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,0.3)",e.fillStyle="rgba(0,0,0,0.25)",e.arc(t.centerX,t.centerY,10,0,2*Math.PI,!0),e.stroke(),e.fill(),e.restore()},drawRing:function(){var t=this,e=t.context;e.save(),e.beginPath(),e.shadowColor="rgba(0,0,0,0.7)",e.shadowOffsetX=4,e.shadowOffsetY=4,e.shadowBlur=8,e.fillStyle="rgba(0,0,0,0.16)",e.strokeStyle="rgba(0,0,0,0.25)",e.arc(t.centerX,t.centerY,t.ringOuterRadius,0,2*Math.PI,!1),e.stroke(),e.strokeStyle="rgba(0,0,0,0.2)",e.arc(t.centerX,t.centerY,t.ringInnerRadius,0,2*Math.PI,!0),e.fill(),e.beginPath(),e.arc(t.centerX,t.centerY,t.ringInnerRadius,0,2*Math.PI,!0),e.stroke(),e.restore()},drawTicks:function(){var t,e,n=this,r=n.context,i=n.ringInnerRadius-n.hourTickLen,a=n.ringInnerRadius-n.minTickLen,o=Math.PI,c=-o/2,s=2*o/48,l=0,h=0,d=0,u=0,g=c;r.save(),r.lineWidth=1,r.textAlign="center",r.textBaseline="middle",r.font="normal 12px 微软雅黑";for(var x=0;x<48;x++)t=x%4==0?i:a,r.lineWidth=x%4==0?2:1,r.strokeStyle="rgba(0,0,0,0.2)",l=n.centerX+Math.cos(g)*t,h=n.centerY+Math.sin(g)*t,d=n.centerX+Math.cos(g)*n.ringInnerRadius,u=n.centerY+Math.sin(g)*n.ringInnerRadius,r.beginPath(),r.moveTo(l,h),r.lineTo(d,u),r.stroke(),x%4==0&&(e=x/4,e=0==e?12:e,r.strokeStyle="rgba(0,0,0,0.5)",r.strokeText(e,n.centerX+Math.cos(g)*(t-10),n.centerY+Math.sin(g)*(t-10))),g+=s;r.restore()},drawPoints:function(){var t=this,e=t.context,n=Math.PI,r=new Date,i=r.getHours(),a=r.getMinutes(),o=r.getSeconds(),c=55,s=-n/2+2*n/12*(i%12),l=85,h=-n/2+2*n/60*a,d=115,u=-n/2+2*n/60*o;t.lastTime=r.getTime(),e.save(),e.lineCap="round",e.strokeStyle="rgba(0,0,0,0.5)",e.lineWidth=4,e.beginPath(),e.moveTo(t.centerX,t.centerY),e.lineTo(t.centerX+c*Math.cos(s),t.centerY+c*Math.sin(s)),e.stroke(),e.lineWidth=3,e.beginPath(),e.moveTo(t.centerX,t.centerY),e.lineTo(t.centerX+l*Math.cos(h),t.centerY+l*Math.sin(h)),e.stroke(),e.lineWidth=2,e.beginPath(),e.moveTo(t.centerX,t.centerY),e.lineTo(t.centerX+d*Math.cos(u),t.centerY+d*Math.sin(u)),e.stroke();var g=(i<10?"0"+i:i)+" : "+(a<10?"0"+a:a)+" : "+(o<10?"0"+o:o);e.font="normal 14px 微软雅黑",e.textAlign="center",e.textBaseline="middle",e.strokeStyle="rgba(0,0,0,0.5)",e.lineWidth=1,e.strokeText(g,t.centerX,t.centerY+45);var x=r.getMonth()+1,m=r.getDate(),v=r.getDay(),f=["日","一","二","三","四","五","六"];g=r.getFullYear()+" / "+(x<10?"0"+x:x)+" / "+(m<10?"0"+m:m)+" 星期"+f[v],e.strokeText(g,t.centerX,t.centerY+75),e.restore()}}},c=o,s=n("17cc"),l=Object(s["a"])(c,r,i,!1,null,null,null);e["default"]=l.exports},"15c2":function(t,e,n){"use strict";var r=n("db4b"),i=n("5fe5"),a=n("b146");t.exports=function(t){var e=r(this),n=a(e.length),o=arguments.length,c=i(o>1?arguments[1]:void 0,n),s=o>2?arguments[2]:void 0,l=void 0===s?n:i(s,n);while(l>c)e[c++]=t;return e}},"1c74":function(t,e,n){var r=n("b2f5");r(r.P,"Array",{fill:n("15c2")}),n("644a")("fill")},"3ad6":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},i=[],a=(n("f763"),n("eb57")),o={data:function(){return{catalog:[],showPreview:!1,previewList:[],previewIndex:0}},mounted:function(){var t=this;t.$store.commit(a["a"].SWITCH_LOADING,!1),t.$nextTick(function(){window.addEventListener("scroll",t.doHandlerScroll);var e=document.querySelectorAll("code");e.length>0&&e.forEach(function(t){hljs.highlightBlock(t)});var n=document.querySelectorAll("h3.title");if(n.length>0){var r=[],i=Math.round(1e6*Math.random()),a="";t.catalog=n.forEach(function(t,e){a="section"+i+"-"+e,t.setAttribute("id",a),r.push({text:t.innerHTML,id:a,el:t,active:!1})}),t.catalog=r}var o=document.querySelectorAll(".content figure>img");o.length>0&&t.getImageSize(0,o)})},methods:{getImageSize:function(t,e){var n=this,r=new Image,i=e[t];r.onload=function(){n.previewList.push({src:i.src,w:this.width,h:this.height}),t++,t<e.length?n.getImageSize(t,e):n.$el.addEventListener("click",n.doPreview)},r.src=i.src},doPreview:function(t){var e=this;if(/img/i.test(t.target.tagName)&&!e.showPreview&&!t.target.classList.contains("pswp__img")){e.previewIndex=0;for(var n=0;n<e.previewList.length;n++)if(e.previewList[n].src==t.target.src){e.previewIndex=n;break}e.showPreview=!0}},doHandlerScroll:function(){for(var t,e,n=this,r=n.catalog.length-1;r>=0;r--)if(t=n.catalog[r].el,t.getBoundingClientRect().top<10){e=r;break}n.catalog=n.catalog.map(function(t,n){return t.active=n==e,t})}},beforeDestroy:function(){var t=this;window.removeEventListener("scroll",t.doHandlerScroll),t.previewList.length>0&&t.$el.removeEventListener("click",t.doPreview)}},c=o,s=n("17cc"),l=Object(s["a"])(c,r,i,!1,null,null,null);e["a"]=l.exports}}]);