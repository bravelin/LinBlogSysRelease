(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19d4dc7d"],{"0334":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-container article-page"},[n("h2",{staticClass:"title"},[t._v("ES6标准入门笔记之三：字符串的扩展")]),t._m(0),n("footer",[t._v("2017年03月11日")]),n("Comments"),n("Catalog",{attrs:{catalog:t.catalog}})],1)},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content"},[n("h3",{staticClass:"title"},[t._v("字符的Unicode表示法")]),n("p",[t._v("JS中可以使用\\uxxxx表示一个字符，但这个表示法仅限于\\u0000-\\uffff之间的字符，超出这个范围的字符，必须用2个双字节的形式表达。")]),n("pre",[n("code",[t._v('"\\uD842\\uDFB7" // "𠮷"\n"\\u20BB7"  // "₻7"\n"\\u{20BB7}" // "𠮷"')])]),n("p",[t._v("如果直接在\\u后面跟上超过0xffff的数值，JS会理解成\\u20BB+7。在ES6中，将码点放入大括号中即可正确解读该字符，并且大括号表示法与四字节的UTF-16编码是等价的。")]),n("p",[t._v("可以使用以下六种方式表示一个字符：")]),n("pre",[n("code",[t._v("'\\z'\n'\\172'  // 八进制\n'\\x7A'  // 十六进制\n'\\u007A'\n'\\u{7A}'")])]),n("h3",{staticClass:"title"},[t._v("codePointAt()")]),n("p",[t._v("在JS内部，字符以UTF-16的格式存储，每个字符固定为2个字节。对于那些需要4个字节存储的字符（码点大于0xFFFF），JS会认为它们是两个字符：")]),n("pre",[n("code",[t._v("var s = '\\u{20BB7}'\ns.length // 2\ns.charCodeAt(0) // 55362\ns.charCodeAt(1) // 57271\ns.codePointAt(0) // 134071")])]),n("p",[t._v("codePointAt可以正确处理4个字节存储的字符，返回一个字符的码点（十进制表示）。而对于两个字节存储的常规字符，它的返回结果与charCodeAt一样。")]),n("pre",[n("code",[t._v("var s = '\\u{20BB7}a' // 在JS中长度是3\ns.codePointAt(0).toString(16) // 20BB7\ns.codePointAt(2).toString(16) // 61，正确序号其实是1")])]),n("p",[t._v("可以使用for of循环遍历字符：")]),n("pre",[n("code",[t._v("var s = '\\u{20BB7}a'\nfor(let ch of s){ console.log(ch.codePointAt(0).toString(16)) }")])]),n("p",[t._v("测试一个字符是由两个字节组成还是四个字节组成：")]),n("pre",[n("code",[t._v("function is32Bit(c) { return c.codePointAt(0) > 0xffff }")])]),n("h3",{staticClass:"title"},[t._v("String.fromCodePoint")]),n("p",[t._v("ES5的String.fromCharCode方法用于从码点返回对应字符，但这个方法不能识别32位的UTF-16字符。String.fromCodePoint方法则可以。在作用上，与codePointAt方法相反。")]),n("h3",{staticClass:"title"},[t._v("字符串的遍历器接口")]),n("p",[t._v("ES6为字符串提供了遍历器接口，使字符串可以由for...of循环遍历。")]),n("pre",[n("code",[t._v("for(let codePoint of 'foo') { console.log(codePoint) }\n// 'f'\n// 'o'\n// 'o'")])]),n("p",[t._v("这个遍历器的最大优点是可以识别大于0xFFFF的码点。")]),n("h3",{staticClass:"title"},[t._v("at()")]),n("p",[t._v("ES5中的charAt方法返回字符串给定位置的字符，该方法不能识别大于0xffff的字符。at方法则可以识别。")]),n("h3",{staticClass:"title"},[t._v("includes()、startsWidth()、endsWidth()")]),n("p",[t._v("除了indexOf()之外，es6提供的这3种方法也可以确定一个字符串是否包含在另外的一个字符串中。")]),n("p",[t._v("includes()：返回布尔值，表示是否找到了参数字符串。")]),n("p",[t._v("startsWidth()：返回布尔值，表示参数字符串是否在源字符串的头部。")]),n("p",[t._v("endsWidth()：返回布尔值，表示参数字符串是否在源字符串的尾部。")]),n("p",[n("strong",[t._v("这3个方法都支持第二个参数n，表示开始搜索的位置。(endsWidth的n表示前n个字符)")])]),n("h3",{staticClass:"title"},[t._v("repeat()")]),n("p",[t._v("repeat方法返回一个新的字符串，表示将原字符重复n次。（参数会被转成整数。）")]),n("h3",{staticClass:"title"},[t._v("padStart()、padEnd()")]),n("p",[t._v("ES7推出了字符串补全功能，如果某个字符串未达到指定的长度，则在头部或者尾部补全之。")]),n("pre",[n("code",[t._v("'x'.padStart(5,'ab') // ababx\n'x'.padEnd(5,'ab') // xabab")])]),n("p",[t._v("第一个参数指定字符串的最小长度，第二个参数（默认为空格）则是用来补全的字符串。")]),n("h3",{staticClass:"title"},[t._v("模板字符串")]),n("p",[t._v("模板字符串（template string）是增强版的字符串，使用反撇号（`：一般和~是同一个按键）标识。它可以当做普通字符串使用，也可以用来定义多行字符串，或者在字符串中嵌入变量：")]),n("pre",[n("code",[t._v("`In JavaScript '\\n' is a line-feed` // 普通字符串\n\n// 多行字符串，可以直接换行\n`In JavaScript this is\n    not legal`\n\n// 在字符串中嵌入变量\nvar name = 'bob', time = 'today'\n`Hello ${name}, how are you ${time}` // Hello bob, how are you today")])]),n("p",[n("strong",[t._v("如果在模板字符串中使用反撇号，则前面需要使用反斜杠转义。")]),t._v("如果使用模板字符串表示多行字符，则所有的缩进和空格都会保留在输出中。")]),n("p",[t._v("在模板字符串中嵌入变量，需要写在\n                "),n("strong",[t._v(" ${} ")]),t._v("中。大括号内可以放入任意的JavaScript表达式（甚至调用函数），可以进行运算，以及引用对象的属性。")]),n("pre",[n("code",[t._v("var x = 1, y = 2\n`${x} + ${y} = ${ x+ y}`\n\nfunction fn() { return 'good luck!' }\n`foo ${fn()} boo` // foo good luck! boo")])]),n("p",[t._v("如果大括号中的对象不是字符串，则会调用对象的toString()方法转为字符串。如果引用的对象没有声明，则报错。")]),n("h3",{staticClass:"title"},[t._v("模板编译")]),n("p",[t._v("待编译的模板：")]),n("pre",[n("code",[t._v("var template = `\n<ul>\n    <% for(var i = 0; i < data.length; i++) { %>\n        <li><%= data[i] %></li>\n    <% } %>\n</ul>\n                `")])]),n("p",[t._v("使用正则表达式将其转为JavaScript表达式字符串：")]),n("pre",[n("code",[t._v("var evalExpr = /<%=(.+?)%>/g\nvar expr = /<%([\\s\\S]+?)%>/g\ntemplate = template.replace(evalExpr, '`); \\n echo( $1 ); \\n echo(`').replace(expr, '`); \\n $1 \\n echo(`')\ntemplate = 'echo(`' + template + '`)'")])]),n("p",[t._v("处理之后的结果是：")]),n("pre",[n("code",[t._v("echo(`<ul>`);\nfor(var i = 0; i < data.length; i++) {\n     echo(`<li>`);\n     echo(  data[i]  );\n     echo(`</li>`);\n}\necho(`</ul>`)")])]),n("p",[t._v("最终的脚本：")]),n("pre",[n("code",[t._v("var script = `(function parse(data){\n    var output = ''\n    function echo (html) { output += html }\n    ${ template }\n    return output\n})`")])]),n("h3",{staticClass:"title"},[t._v("标签模板（tagged template）")]),n("p",[t._v("模板字符串可以紧跟在一个函数名的后面，该函数将被调用来处理这个模板字符串。")]),n("p",[n("strong",[t._v('标签模板其实不是模板，而是函数调用的一种形式。"标签"指的是函数，紧跟在后面的模板字符串就是它的参数。')])]),n("pre",[n("code",[t._v("var a = 5, b = 10\ntag `Hello ${ a + b } world ${ a * b }`\n\nfunction tag (stringArr, ...values) {}\n// 实际上是 tag (['Hello ', ' world', ''], 15, 50)")])]),n("p",[t._v("tag函数的第一个参数是一个数组，该数组的成员是模板字符串中那些没有变量替换的部分。其他参数是模板字符串中各个变量被替换之后的值。")]),n("p",[t._v("tag函数的第一个参数有一个raw属性，也指向一个数组。该数组的成员与此参数数组几乎完全一致。两者唯一的区别，是字符串里面的反斜杠被转义了。")]),n("h3",{staticClass:"title"},[t._v("String.raw()")]),n("p",[t._v("通常用来充当模板字符串的处理函数，返回一个反斜线都被转义的字符串，对应于替换变量之后的模板字符串\n                "),n("strong",[t._v("（好像不太对）")]),t._v("：")]),n("pre",[n("code",[t._v("String.raw `Hi\\n ${ 1 + 2 }` // Hi\\\\n 3，实际中chrome输出Hi\\n 3")])])])}],o=n("3ad6"),r={extends:o["a"]},l=r,c=n("4e82"),s=Object(c["a"])(l,a,i,!1,null,null,null);e["default"]=s.exports},"3ad6":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},i=[],o=(n("4634"),n("eb57")),r={data:function(){return{catalog:[],showPreview:!1,previewList:[],previewIndex:0}},mounted:function(){var t=this;t.$store.commit(o["a"].SWITCH_LOADING,!1),t.$nextTick((function(){window.addEventListener("scroll",t.doHandlerScroll);var e=document.querySelectorAll("code");e.length>0&&e.forEach((function(t){hljs.highlightBlock(t)}));var n=document.querySelectorAll("h3.title");if(n.length>0){var a=[],i=Math.round(1e6*Math.random()),o="";t.catalog=n.forEach((function(t,e){o="section"+i+"-"+e,t.setAttribute("id",o),a.push({text:t.innerHTML,id:o,el:t,active:!1})})),t.catalog=a}var r=document.querySelectorAll(".content figure>img");r.length>0&&t.getImageSize(0,r)}))},methods:{getImageSize:function(t,e){var n=this,a=new Image,i=e[t];a.onload=function(){n.previewList.push({src:i.src,w:this.width,h:this.height}),t++,t<e.length?n.getImageSize(t,e):n.$el.addEventListener("click",n.doPreview)},a.src=i.src},doPreview:function(t){var e=this;if(/img/i.test(t.target.tagName)&&!e.showPreview&&!t.target.classList.contains("pswp__img")){e.previewIndex=0;for(var n=0;n<e.previewList.length;n++)if(e.previewList[n].src==t.target.src){e.previewIndex=n;break}e.showPreview=!0}},doHandlerScroll:function(){for(var t,e,n=this,a=n.catalog.length-1;a>=0;a--)if(t=n.catalog[a].el,t.getBoundingClientRect().top<10){e=a;break}n.catalog=n.catalog.map((function(t,n){return t.active=n==e,t}))}},beforeDestroy:function(){var t=this;window.removeEventListener("scroll",t.doHandlerScroll),t.previewList.length>0&&t.$el.removeEventListener("click",t.doPreview)}},l=r,c=n("4e82"),s=Object(c["a"])(l,a,i,!1,null,null,null);e["a"]=s.exports},4634:function(t,e,n){for(var a=n("96dd"),i=n("7d56"),o=n("a6d5"),r=n("3f8b"),l=n("b8ea"),c=n("e3b3"),s=n("1277"),v=s("iterator"),d=s("toStringTag"),p=c.Array,u={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=i(u),f=0;f<h.length;f++){var g,_=h[f],S=u[_],m=r[_],L=m&&m.prototype;if(L&&(L[v]||l(L,v,p),L[d]||l(L,d,_),c[_]=p,S))for(g in a)L[g]||o(L,g,a[g],!0)}}}]);